# Проект для Викишоп  

## Задание

Интернет-магазин «Викишоп» запускает новый сервис. Теперь пользователи могут редактировать и дополнять описания товаров, как в вики-сообществах. То есть клиенты предлагают свои правки и комментируют изменения других. Магазину нужен инструмент, который будет искать токсичные комментарии и отправлять их на модерацию.

Обучите модель классифицировать комментарии на позитивные и негативные. В вашем распоряжении набор данных с разметкой о токсичности правок.

Постройте модель со значением метрики качества `F1` не меньше 0.75. Решить задачу можно как с помощью `BERT`, так и без этой нейронки.  

## Описание данных

Данные находятся в файле `toxic_comments.csv`. Столбец `text` в нём содержит текст комментария, а `toxic` — целевой признак.  

## Ход работы

1. Загрузили и проверили данные. Выявилась проблема дисбаланса классов.  
2. Для решения проблемы дисбаланся принято решение выполнить сэмплирование с помощью SMOTE в пайплайне.  
3. Подготовку текстов к обучению моделей сделаем с помощью нейронки `BERT`.  
4. Чтобы не создавать эмбеддинги слишком долго, выбрали 10000 случайных текстов из наших данных.  
5. После создания векторов разделили данные на тренировочную и тестовую выборки.  
6. В пайплайне обучили несколько моделей:  
логистическую регрессию,  
случайный лес,  
бустинговую модель `CatBoost`.  
7. Для каждой модели перебрали гиперпараметры, используя RandomizedSearchCV. Балансировку данных также выполняли в пайплайне.  
8. Для оценки качества использовали метрику `F1`.  
9. Лучшей моделью стала `CatBoostRegression`.  
10. Метрика качества на тренировочной и тестовой выборке не соответствует требованиям заказчика.  

**Основные выводы:** Не удалось создать модель для определения токсичности комментариев нужного качества на данных, подготовленных нейронной сетью, так как пришлось выбрать только часть текстов для обучения по причине нехватки вычислительных мощностей.